import socket
import re

shell = "2019shell1.picoctf.com"
port = 9525
s = socket.socket()
print("[*] Connecting to Shell %s on port %s" % (str(shell),str(port)))
s.connect((shell,port))
print("[*] Doing Black magic")
peer = s.getpeername()
print("[*] Connected to %s " % str(peer))
r = s.recv(1024)
print("[*] working Hard")
while "}" not in str(r):
    r = s.recv(1024)
    result = re.findall("picoCTF{\w*}", str(r))
    result = str(result).strip("[]'")
if not result.strip():
    print("[*] Bad Luck my friend")
else:
    print("[*] Lucky you, flag is : %s " % result)


print("[*] Closing Shell")
s.close()
