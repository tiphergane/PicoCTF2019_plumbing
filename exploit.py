#coding:utf-8
import socket
import re

shell = "2019shell1.picoctf.com"
port = 9525
regex = "picoCTF{\w*}"

def SockClose():
    print("[*] Closing Shell")
    s.close()
    input()
    
def Exploit():
    s.connect((shell,port))
    print("[*] Doing Black magic")
    peer = s.getpeername()
    print("[*] Connected to %s " % str(peer))
    r = s.recv(1024)
    print("[*] working Hard")
    while "}" not in str(r):
        r = s.recv(1024)
        result = re.findall(regex, str(r))
        result = str(result).strip("[]'")
    if not str(result).strip():
        print("[*] Bad Luck my friend")
    else:
        print("[*] Lucky you, flag is : %s " % result)


try : 
    print("[*] Connecting to Shell %s on port %s" % (str(shell),str(port)))
    s = socket.socket()
    Exploit()
except :
    print("[*] Impossible de se connecter au Shell %s " % str(shell))    
finally :
    SockClose()
